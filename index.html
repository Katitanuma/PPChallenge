<!DOCTYPE html>
<html>
<head>
	<title>Challenge Pixel Pay</title>	
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>
<body>
	<div class="container">	
		</br>		
		<h1 class="text-primarys text-center">Pixel Pay Challenge</h1>
		</br>	
 		<div class="row"> 			
 			<div class="col-md-5">
 				<div class="card">
 					<div class="card-header">
 						<h4>Agregar</h4>
 						 <input type="text" id="nombre" class="form-control" aria-label="Large" aria-describedby="inputGroup-sizing-sm" placeholder="Escribe y presiona enter para agregar un quehacer" >
 					</div>
 					<div class="card-body">
 						
 					</div>
 				</div>
 				
 			</div>
 			<div class="col-md-7">
 				
 				<div class="row">
				    <div class="col-6">
				      <h4> Listado de Quehaceres</h4>
				    </div>				    
				    <div class="col-3">
				      <button type="button" class="btn btn-warning btn-sm">Eliminar Marcados</button>
				    </div>
				    <div class="col-3">
				      <button type="button" class="btn btn-danger btn-sm">Eliminar Todo</button>
				    </div>
				 </div> 				
 				<hr/>
 				<div id="quehaceres">
 				</div> 				
 			</div>

 			
 		</div>
	</div>
	
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
	<script>
		var url="http://localhost/PPChallenge/";
		var aplicacion = new function(){
			this.nombre = document.getElementById("nombre");

			this.quehaceres = document.getElementById("quehaceres");

			this.leer = function(){
				var datos="";

				fetch(url)
				.then(r=>r.json())
				.then((respuesta)=>{
					console.log(respuesta)

					respuesta.map(
						function(quehacer,index,array){
							datos+=`<ul class="list-group" >
									<div class="form-check mb-2 mr-sm-2">
							       		<input class="form-check-input" type="checkbox" id="inlineFormCheck">
							       		<label class="form-check-label" for="inlineFormCheck">
							      			`+quehacer.nombre+
							    		`</label>
							  	    </div>
							  	   </ul>
								   <hr/>`;
						}

					);
					return this.quehaceres.innerHTML=datos;
				})
				.catch(console.log)				
				
			}

			this.agregar = function(){
				console.log(nombre.value);

				var datosEnviar = {nombre: this.nombre.value}

				fetch(url+"?insertar=1",{method:"POST",body:JSON.stringify(datosEnviar)})
				.then(r=>r.json())
				.then((respuesta)=>{
					console.log("Datos insertados");
					nombre.value = '';
					this.leer();					
				})
				.catch(console.log)	
			}
		}

		aplicacion.leer();

		
		$(document).ready(function() 
            {    
           
              $('#nombre').keypress(function(e){   
               if(e.which == 13){      
                 aplicacion.agregar();      
               }   
              });    
              
           });  

	</script>

	

</body>
</html>